**Malware Analysis** is the process of examining suspicious files or behavior to understand how malicious software operates, how it infects systems, and how to mitigate its impact. The analysis can be **static** (code-level) or **dynamic** (behavioral), and is critical for incident response, threat hunting, and threat intelligence.

---

## üéØ Goals of Malware Analysis

- Determine **capabilities** and **intent** of malware
- Identify **persistence**, **C2**, and **payload delivery**
- Extract **IOCs** (Indicators of Compromise)
- Develop **detection signatures** (YARA, AV, IDS/IPS)
- Support **incident response** and containment strategies

---

## üîÅ Malware Analysis Stages

### 1. üßπ Triage (Initial Inspection)

- File type, size, and metadata inspection
- Calculate **hashes** (MD5, SHA-1, SHA-256)
- Submit to **VirusTotal**, **Hybrid Analysis**, or **Intezer**
- Identify PDB strings, compile times, and possible packing

```bash
sha256sum sample.exe
file sample.exe
strings sample.exe | less
```

### 2. üß™ Static Analysis

- Analyze without executing the malware
- Tools: `PEStudio`, `Detect It Easy (DiE)`, `Ghidra`, `IDA Free`

|Static Task|Tools/Methods|
|---|---|
|File structure analysis|PE headers, sections, imports, exports|
|String extraction|`strings`, `Floss`|
|Obfuscation/Packing|Detect It Easy, entropy analysis|
|Disassembly|IDA Free, Ghidra, Radare2|
|Signature matching|YARA, ClamAV, AV engines|

---

### 3. üî¨ Dynamic Analysis

- Execute malware in a **sandboxed** or **isolated environment**
- Monitor **behavior, IOCs, and system changes**

|Monitor|Description|
|---|---|
|**Process Monitor**|File, registry, process, and thread activity|
|**Wireshark / TCPView**|Network connections and DNS queries|
|**Procmon / Process Hacker**|Process tree, privilege changes, memory injection|
|**Cuckoo Sandbox**|Automated execution, behavior report, screenshots|

**Tip:** Always snapshot VM and disable outbound internet unless analyzing C2.

---

### 4. üï∏ Behavioral Analysis

- Extract indicators and infer malware behavior:

|Behavior Category|Example|
|---|---|
|**Persistence**|Registry Run keys, scheduled tasks|
|**Evasion**|Anti-VM, anti-debug, sleep timers|
|**C2 Communication**|HTTP/HTTPS beaconing, DNS tunneling|
|**Privilege Escalation**|UAC bypass, token stealing|
|**Payload Execution**|Droppers, PowerShell or LOLBin use|

---

### 5. üßæ IOC Extraction & Reporting

|IOC Type|Examples|
|---|---|
|**Hashes**|MD5, SHA1, SHA256|
|**Filenames**|temp payloads, DLLs, dropped files|
|**Registry Keys**|Persistence and configuration storage|
|**IP addresses**|C2 infrastructure|
|**Domains/URLs**|Beaconing or phishing landing pages|
|**YARA/ClamAV rules**|Custom signatures for detection|

---

## üß∞ Recommended Tools

|Category|Tools|
|---|---|
|Static Analysis|PEStudio, Ghidra, IDA Free, DiE|
|Dynamic Analysis|Cuckoo Sandbox, Process Monitor, Procmon, Wireshark|
|Memory Forensics|Volatility, Rekall|
|IOC Extraction|CyberChef, IOC Parser, YARA|
|Automation|CAPE Sandbox, Any.Run, FLARE VM|

---

## üõ°Ô∏è Best Practices

- Use **isolated, non-networked VMs** for analysis
- Log all artifacts and generate **forensic timelines**
- Never trust automated analysis alone‚Äî**verify manually**
- Store samples in encrypted containers (`.zip` with password `infected`)
- Follow **chain of custody** when needed

---

## üîó Related Topics

- [[Digital Forensics Tools]]
- [[Fileless Malware]]
- [[Command and Control (C2)]]
- [[Persistence Mechanisms]]
- [[WMI Abuse]]
- [[YARA Rule Development]]

---

## üè∑ Tags

#malware_analysis #digital_forensics #static_analysis #dynamic_analysis #IOC #sandbox #reverse_engineering #incident_response