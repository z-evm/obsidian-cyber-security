**Message Authentication Codes (MACs)** provide a way to ensure the **authenticity** and **integrity** of data using shared secrets. A special type, the **HMAC (Hash-based Message Authentication Code)**, combines hash functions with secret keys for secure verification.

---

## 🎯 Purpose of MACs

- Verify that a message **was not altered**
- Prove the message was **generated by someone with the shared key**
- Used in **secure communication protocols**, file validation, and authentication

> 💡 MACs do **not provide encryption** — they validate message **authenticity and integrity**, not confidentiality.

---

## 🧩 What is a MAC?

A **MAC** is a short piece of information used to **authenticate** a message.

### Inputs:
- Message (data to be authenticated)
- Secret Key
- Cryptographic function (usually a hash or cipher)

### Output:
- A **tag** (the MAC) that is verified on the receiver’s end using the same secret key.

---

## 🔐 HMAC: Hash-based MAC

**HMAC** is a type of MAC that uses a **hash function + secret key**.

### How HMAC Works:

```text
HMAC(K, m) = H[(K' ⊕ opad) ∥ H[(K' ⊕ ipad) ∥ m]]
```

- `H` = cryptographic hash function (e.g., SHA-256)
- `K` = secret key
- `m` = message
- `⊕` = XOR operation
- `ipad`/`opad` = inner/outer padding constants

### Features:

- Resistant to length extension attacks
- Supported in TLS, IPSec, JWT, AWS signing, and more

---

## 🔄 MAC vs HMAC

|Feature|MAC|HMAC|
|---|---|---|
|**Algorithm**|Can be based on cipher or hash|Always based on a hash function|
|**Key Usage**|Secret key + message|Secret key + message (through hashing)|
|**Use Case**|Custom protocols, TLS, IPSec|TLS, SSH, HTTPS, web APIs, OAuth|
|**Performance**|Varies|Very efficient and secure (if SHA-2 used)|

---

## 🧰 Use Cases for MAC and HMAC

|Scenario|Application|
|---|---|
|**TLS/SSL Handshake**|Verifies integrity of messages during setup|
|**API Authentication**|AWS, Azure use HMAC for request signing|
|**JWT (JSON Web Tokens)**|Use HMAC-SHA256 to sign payloads|
|**File Verification**|Ensure files haven’t been tampered with|
|**IPSec / VPNs**|Packet authentication|

---

## ⚠️ Security Considerations

- Must **keep the key secret** — if exposed, MACs can be forged
- Use a **strong hash function** (SHA-256 or SHA-3)
- Avoid using outdated hashes like MD5 or SHA-1 with HMAC
- HMAC is **only as secure as its key and underlying hash**

---

## ✅ Best Practices

- Always use **unique keys** per session/user when possible
- **Rotate keys** periodically
- Use **SHA-256 or higher** as the underlying hash function
- **Avoid symmetric MACs** for scenarios requiring non-repudiation (use digital signatures instead)

---

## 🧪 HMAC Example (Python)
```
import hmac
import hashlib

key = b'supersecretkey'
message = b'important-data'
mac = hmac.new(key, message, hashlib.sha256).hexdigest()

print(mac)
```

The receiver must compute the same HMAC using the same key and compare results.

## 🗂 Related Topics

- [[Hashing]]
- [[Digital Signatures]]
- [[Symmetric vs Asymmetric Encryption]]
- [[Transport Layer Security & Secure Sockets Layer (TLS & SSL)]]
- [[Authentication Protocols]]
- [[Data Integrity]]

---

## 🏷 Tags

#hmac #mac #hashing #message_authentication #integrity #authentication #cryptography #security+ #symmetric_cryptography