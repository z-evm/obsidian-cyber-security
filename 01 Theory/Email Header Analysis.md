# ✉️ Email Header Analysis

**Email header analysis** is the process of examining the metadata in an email’s header to trace its origin, verify sender identity, and detect **phishing**, **spoofing**, or **malware delivery** attempts. It's a crucial step in **incident response** and **forensics**.

---

## 🎯 Purpose of Email Header Analysis

- Validate the **true origin** of a message
- Detect **spoofed senders** or forged domains
- Analyze **email routing paths**
- Investigate **phishing attempts**, spam, or targeted attacks
- Correlate with other IOCs (Indicators of Compromise)

---

## 📦 Key Email Header Fields (With Examples)

### 1. `Received:`
> Shows the **path** the email took between mail servers, top-down.

```plaintext
Received: from mail.evilsite.com (198.51.100.10) by mx.target.com ...
```

- Review all hops from **bottom to top**
- Watch for unknown IPs or suspicious domain handoffs

---

### 2. `From:`

> The **display sender name and email** (user-visible)

```
From: "Microsoft Security" <admin@micr0s0ft-support.com>
```
⚠️ Can be spoofed! Always cross-check with `Return-Path` and `DKIM`.

### 3. `Return-Path:`

> Address where **bounces** go — often reveals the **real sender**

```
Return-Path: <attacker@evilmail.xyz>
```

### 4. `Reply-To:`

> Specifies where replies should be sent — often **different from From**

```
Reply-To: support@fraudulent-help.com
```

### 5. `Message-ID:`

> Unique ID generated by the **sending server**

```
Message-ID: <d3fc1c23@evilserver.ru>
```
Strange or mismatching domains can signal spoofing.

### 6. `Subject:`

> Often contains **urgency**, **social engineering**, or **typos**

```
Subject: Urgent: Verify your account or be locked out
```

### 7. `DKIM-Signature:`

> Digital signature verifying sender domain integrity

- If present and **valid**, confirms the domain truly sent it.
- Use online tools or mail server logs to verify.

---

### 8. `Authentication-Results:`

> Summarizes SPF, DKIM, and DMARC outcomes

```
Authentication-Results: spf=fail; dkim=pass; dmarc=fail
```

|Check|Result Description|
|---|---|
|**SPF**|Sender’s IP matches allowed list|
|**DKIM**|Signature matches domain’s public key|
|**DMARC**|Domain policy enforcement result|

> A `fail` on SPF or DMARC is a **red flag**.

---

## 🧰 Tools for Analyzing Email Headers

|Tool|Use Case|
|---|---|
|MXToolbox Analyzer|Web-based full header parser|
|Microsoft Message Header Analyzer|Built into Outlook or web-based|
|Google Admin Toolbox|Header decode for Google Workspace|
|Thunderbird / Outlook|Raw header view (Ctrl+U or View > Source)|

---

## 🧪 Real-World Red Flags

- Misspelled domains: `micr0s0ft.com`, `amaz0n.support`
- Mismatch between `From:` and `Return-Path`
- `SPF=fail`, `DKIM=none`, `DMARC=fail`
- IPs belonging to cloud VPS or suspicious geolocations
- `Received:` shows hop from unexpected mail servers

---

## ✅ Best Practices

- ✅ Train analysts to read headers manually
- ✅ Validate SPF/DKIM/DMARC with trusted tools
- ✅ Use SIEM to alert on domain mismatches or auth failures
- ✅ Correlate with user reports and EDR/network logs
- ✅ Archive headers for incident and forensic review

---

## 🗂 Related Topics

- [[Phishing Response Workflow]]
- [[SPF, DKIM, DMARC]]
- [[SIEM & Log Analysis]]
- [[Phishing Defense Techniques]]
- [[Secure Email Gateway (SEG)]]
- [[Threat Hunting]]

---

## 🏷 Tags

#email_security #header_analysis #phishing #spoofing #spf #dmarc #dkim #security+ #incident_response #forensics

