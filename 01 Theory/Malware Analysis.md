**Malware analysis** is the process of studying malicious code or binaries to understand their behavior, functionality, origin, and impact. It's a key component of **incident response**, **threat intelligence**, and **defensive countermeasures**.

---

## üéØ Objectives of Malware Analysis

- Identify **what the malware does** and how
- Detect **indicators of compromise (IOCs)**
- Understand **persistence**, **lateral movement**, or **data exfiltration**
- Develop **YARA/Sigma rules** for detection
- Inform **containment**, **eradication**, and **recovery**

> Malware analysis transforms an unknown binary into actionable intelligence.

---

## üß± Types of Malware Analysis

| Type               | Description                                              | Tools Used                              |
|--------------------|----------------------------------------------------------|------------------------------------------|
| **Static Analysis** | Examine file without execution                          | Strings, PEiD, Ghidra, VirusTotal        |
| **Dynamic Analysis**| Execute in controlled environment (sandbox/VM)          | Cuckoo, Any.Run, Wireshark, Procmon      |
| **Behavioral Analysis**| Observe file actions (network, registry, filesystem) | EDR, sandbox platforms, Sysinternals     |
| **Memory Analysis** | Analyze malware-infected memory dumps                   | Volatility, Rekall, Redline              |
| **Code-Level (RE)** | Disassemble and reverse engineer binaries               | Ghidra, IDA Pro, Binary Ninja             |

---

## üß™ Malware Classification

| Category         | Description                                     |
|------------------|-------------------------------------------------|
| **Virus**         | Self-replicating code injected into host files |
| **Worm**          | Self-propagates via networks without host files|
| **Trojan**        | Disguised as legitimate software               |
| **Ransomware**    | Encrypts data and demands payment              |
| **Spyware/Stealer**| Steals sensitive info (credentials, keystrokes)|
| **Rootkit**       | Hides malware presence and grants access       |
| **Backdoor/RAT**  | Enables remote access/control by attacker      |
| **Dropper/Loader**| Installs or launches other malicious payloads  |

---

## üîç Indicators of Compromise (IOCs)

| Type           | Examples                                      |
|----------------|-----------------------------------------------|
| **File Hashes** | MD5, SHA256 of malware samples                |
| **Filenames**   | `svhost32.exe`, `invoice.pdf.exe`             |
| **Registry Keys**| `HKCU\Software\Microsoft\Windows\Run`        |
| **Network IOCs**| C2 domains, IPs, DNS beacons, HTTP POSTs      |
| **Mutexes**     | Unique inter-process signaling artifacts      |

---

## üß∞ Tools of the Trade

| Category        | Tools                                         |
|------------------|-----------------------------------------------|
| **Static Tools** | `strings`, PEiD, Detect It Easy, Ghidra        |
| **Dynamic Tools**| Procmon, Wireshark, Regshot, Any.Run, Cuckoo  |
| **Memory Forensics** | Volatility, Redline, Memdump             |
| **Online Services** | VirusTotal, Hybrid Analysis, Intezer      |
| **Reverse Engineering** | IDA Pro, Binary Ninja, Cutter          |

---

## üß† Analysis Workflow

1. **Hash & fingerprint** the sample (MD5/SHA256)
2. **Scan** using VirusTotal or hybrid analysis platforms
3. **Run strings analysis** and identify hardcoded paths, IPs, APIs
4. **Check PE headers** (entry points, packers, anomalies)
5. **Set up sandbox** and observe behavior (file, process, network)
6. **Capture memory dump** and extract injected modules
7. **Reverse engineer** if needed for deeper insights
8. **Document IOCs and behavior** for defense teams

---

## üõ° Defense Recommendations

- Deploy **EDR** with behavioral detection
- Monitor for malware-specific **TTPs** (MITRE ATT&CK)
- Block hashes, domains, and IPs via firewall/DNS
- Educate users about phishing and attachment safety
- Apply patches to prevent exploit-based infections

---

## üìò Example Case: LokiBot

- Delivered via phishing (macro-enabled doc)
- Harvests credentials (FTP, browser, Outlook)
- Uses HTTP POST to send data to hardcoded IP
- Hides via mutex and persistence in `HKCU\Run`

---

## üîó Related Topics

- [[Reverse Engineering]]
- [[Memory Corruption]]
- [[Static vs Dynamic Analysis]]
- [[EDR & Threat Detection]]
- [[Indicators of Compromise (IoC)]]
- [[Incident Response]]
- [[Malware Analysis Workflow]]
- [[Malware Persistence]]
- [[Malware Types]]

---

## üè∑ Suggested Tags

#malware_analysis #reverse_engineering #sandboxing #ioc #ransomware #memory_forensics #dynamic_analysis

---

## ‚úÖ To Do

- [ ] Practice dynamic analysis in Cuckoo sandbox
- [ ] Compare malware families (LokiBot vs AgentTesla)
- [ ] Extract mutexes and C2 info from samples
- [ ] Build YARA rules for known samples
